SELECT
  uid,
  country,
  app_version,
  device_category,
  mobile_brand_name,
  mobile_model_name,
  mobile_marketing_name,
  event_name,
  platform,
  event_timestamp_ms,
  event_timestamp,
  user_creation_timestamp,
  days_retained,
  ltv_revenue,
  up_first_app_version,
  rf1.ep_race_id AS ep_race_id,
  rf1.ep_cup_id AS ep_cup_id,
  up_gems,
  up_coins,
  up_track_level,
  up_first_open_time,
  up_iapPurchasedCount,
  up_track_level_backend,
  up_rank,
  up_user_property_rank,
  ep_coins,
  ep_distance,
  ep_firebase_event_origin,
  ep_firebase_screen,
  ep_firebase_screen_class,
  ep_firebase_screen_id,
  ep_gems,
  ep_level,
  ep_new_best,
  ep_new_level_max,
  ep_old_level_max,
  ep_position,
  ep_race_event,
  ep_chest_slots_open,
  ep_current_level_,
  ep_current_level_air_control,
  ep_current_level_center_of_mass,
  ep_current_level_downforce,
  ep_current_level_engine,
  ep_current_level_fuel_tank,
  ep_current_level_gearbox,
  ep_current_level_grip,
  ep_current_level_power_distribution,
  ep_current_level_rollcage,
  ep_current_level_springs,
  ep_current_level_stability,
  ep_current_level_turbo,
  ep_distance_to_fuel,
  ep_equipped_air_control,
  ep_equipped_coin_boost,
  ep_equipped_flip_speed_boost,
  ep_equipped_fuel_boost,
  ep_equipped_fume_boost,
  ep_equipped_glide,
  ep_equipped_heavyweight,
  ep_equipped_magnet,
  ep_equipped_perfect_landing_boost,
  ep_equipped_rollcage,
  ep_equipped_start_boost,
  ep_equipped_truck_coin_boost,
  ep_equipped_truck_flip_speed_boost,
  ep_equipped_truck_fuel_boost,
  ep_equipped_truck_fume_boost,
  ep_equipped_truck_glide,
  ep_equipped_truck_heavyweight,
  ep_equipped_truck_magnet,
  ep_equipped_truck_perfect_landing_boost,
  ep_equipped_truck_start_boost,
  ep_equipped_truck_turbo_boost,
  ep_equipped_truck_wheelie_boost,
  ep_equipped_truck_winter_tyres,
  ep_equipped_turbo_boost,
  ep_equipped_wheelie_boost,
  ep_equipped_winter_tyres,
  ep_fuel_remaining,
  ep_points_earned,
  ep_race_index,
  ep_time_difference_1,
  ep_time_difference_2,
  ep_time_difference_3,
  ep_time_difference_4,
  ep_race_time,
  ep_reason,
  ep_session_coins,
  ep_session_gems,
  ep_session_time,
  ep_total_coins,
  ep_total_coins_collected,
  ep_total_gems,
  ep_total_play_time,
  ep_total_time,
  ep_type,
  ep_type_specification,
  ep_vehicle,
  ep_wc_rank
FROM (
  SELECT
    uid,
    country,
    app_version,
    device_category,
    mobile_brand_name,
    mobile_model_name,
    mobile_marketing_name,
    event_name,
    platform,
    event_timestamp_ms,
    event_timestamp,
    user_creation_timestamp,
    days_retained,
    ltv_revenue,
    up_first_app_version,
    up_gems,
    up_coins,
    up_track_level,
    up_first_open_time,
    up_iapPurchasedCount,
    up_track_level_backend,
    up_rank,
    up_user_property_rank,
    ep_coins,
    ep_cup_id,
    ep_distance,
    ep_firebase_event_origin,
    ep_firebase_screen,
    ep_firebase_screen_class,
    ep_firebase_screen_id,
    ep_gems,
    ep_level,
    ep_new_best,
    ep_new_level_max,
    ep_old_level_max,
    ep_position,
    ep_race_event,
    ep_race_id,
    ep_race_time,
    ep_reason,
    ep_session_coins,
    ep_session_gems,
    ep_session_time,
    ep_total_coins,
    ep_total_coins_collected,
    ep_total_gems,
    ep_total_play_time,
    ep_total_time,
    ep_type,
    ep_type_specification,
    ep_vehicle,
    ep_wc_rank
  FROM
    [hill-climb-racing-2-67064304:materialized_views.events_flat_20170702]
  WHERE
    (event_name = 'race_finished_1')
    AND uid NOT IN (
    SELECT
      uid
    FROM
      [hill-climb-racing-2-67064304:materialized_views.lifetime_cheaters_hackers])) AS rf1
INNER JOIN (
  SELECT
    ep_chest_slots_open,
    ep_cup_id,
    ep_current_level_,
    ep_current_level_air_control,
    ep_current_level_center_of_mass,
    ep_current_level_downforce,
    ep_current_level_engine,
    ep_current_level_fuel_tank,
    ep_current_level_gearbox,
    ep_current_level_grip,
    ep_current_level_power_distribution,
    ep_current_level_rollcage,
    ep_current_level_springs,
    ep_current_level_stability,
    ep_current_level_turbo,
    ep_distance_to_fuel,
    ep_equipped_air_control,
    ep_equipped_coin_boost,
    ep_equipped_flip_speed_boost,
    ep_equipped_fuel_boost,
    ep_equipped_fume_boost,
    ep_equipped_glide,
    ep_equipped_heavyweight,
    ep_equipped_magnet,
    ep_equipped_perfect_landing_boost,
    ep_equipped_rollcage,
    ep_equipped_start_boost,
    ep_equipped_truck_coin_boost,
    ep_equipped_truck_flip_speed_boost,
    ep_equipped_truck_fuel_boost,
    ep_equipped_truck_fume_boost,
    ep_equipped_truck_glide,
    ep_equipped_truck_heavyweight,
    ep_equipped_truck_magnet,
    ep_equipped_truck_perfect_landing_boost,
    ep_equipped_truck_start_boost,
    ep_equipped_truck_turbo_boost,
    ep_equipped_truck_wheelie_boost,
    ep_equipped_truck_winter_tyres,
    ep_equipped_turbo_boost,
    ep_equipped_wheelie_boost,
    ep_equipped_winter_tyres,
    ep_fuel_remaining,
    ep_points_earned,
    ep_race_id,
    ep_race_index,
    ep_time_difference_1,
    ep_time_difference_2,
    ep_time_difference_3,
    ep_time_difference_4
  FROM
    [hill-climb-racing-2-67064304:materialized_views.events_flat_20170702]
  WHERE
    (event_name = 'race_finished_2')
    AND uid NOT IN (
    SELECT
      uid
    FROM
      [hill-climb-racing-2-67064304:materialized_views.lifetime_cheaters_hackers])) AS rf2
ON
  rf1.ep_race_id = rf2.ep_race_id